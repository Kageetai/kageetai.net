---
import { getCollection, render } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const games = await getCollection('games');
  return games.map(game => ({
    params: { slug: game.id },
    props: { game },
  }));
}

const { game } = Astro.props;
const { Content } = await render(game);
---

<BaseLayout title={game.data.title || game.id}>
  <article>
    <header>
      <h1>{game.data.title || game.id}</h1>
      <aside class="meta">
        <ul>
          <time datetime={game.data.created}>Created: {new Date(game.data.created).toLocaleDateString()}</time>
        {game.data.changed && (
          <time datetime={game.data.changed}>Updated: {new Date(game.data.changed).toLocaleDateString()}</time>
        )}
        </ul>
      </aside>
    </header>

    <Content />

    {game.data.related && (
      <footer>
        <p>Related: {game.data.related}</p>
      </footer>
    )}
  </article>
</BaseLayout>
